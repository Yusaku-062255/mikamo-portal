"""
DXレポートをナレッジベースに登録するシードスクリプト

株式会社みかも DXアプリ開発に向けた事業部門別・包括的リサーチレポートを
6つのセクションに分割してナレッジベースに登録します。

使用方法:
    cd backend
    python scripts/seed_dx_knowledge.py
"""
import sys
import os

# プロジェクトルートをパスに追加
sys.path.insert(0, os.path.dirname(os.path.dirname(__file__)))

from sqlmodel import Session, select
from app.core.database import engine, init_db
from app.models.knowledge_item import KnowledgeItem
from app.models.tenant import Tenant
from app.models.business_unit import BusinessUnit
from app.models.user import User


# DXレポート セクション1: エグゼクティブサマリー＋序論
DX_REPORT_SECTION_1 = """
# 株式会社みかも DXアプリ開発に向けた事業部門別・包括的リサーチレポート

## 1. エグゼクティブ・サマリー

本レポートは、株式会社みかも（以下、貴社）が推進するデジタルトランスフォーメーション（DX）および統合アプリケーション開発の基礎資料として作成されました。貴社が展開する4つの主要事業部門――「カーコーティング Soup（スープ）」、「中古車販売 Mnet（エムネット）」、「みかも喫茶」、「みかも石油（ENEOS）」――について、現在入手可能な公開情報に基づき徹底的な現状分析を行いました。

本調査の目的は、単なる事業概要の整理にとどまらず、各事業のオペレーション詳細、顧客タッチポイント、収益構造の特性を明らかにし、それらをデジタルプラットフォーム上でどのように有機的に結合させるべきかという戦略的インサイトを提示することにあります。

調査の結果、貴社の事業ポートフォリオは、地域住民の「カーライフ（給油・車両売買・メンテナンス）」を基軸としつつ、「ライフスタイル（食）」までをカバーする独自の生態系を形成していることが判明しました。特に、24時間営業のガソリンスタンドという高頻度接触拠点と、高単価な車両販売・コーティング、そしてファンベースを形成する飲食事業の組み合わせは、LTV（顧客生涯価値）を最大化する上で極めて高いポテンシャルを有しています。

本レポートでは、これら4部門の物理的なサービスの強みを、いかにしてデジタルの力で増幅させるか、また物理的な距離（SSと喫茶の立地など）をアプリでどう解消するかについて詳述します。

## 2. 序論：東みよし町における地域密着型DXの意義

### 2.1 地域特性と事業環境

徳島県三好郡東みよし町は、典型的な地方分散型社会であり、移動手段として自家用車への依存度が極めて高い地域です。この環境下において、ガソリンスタンド（SS）は単なる燃料補給所ではなく、生活インフラとしての重要性を持ちます。

貴社の事業構成は、この「車社会」における顧客のライフサイクルを全方位から支えるものです。

- **日常**: みかも石油での給油、みかも喫茶での食事
- **非日常**: Mnetでの車両購入・売却
- **愛着**: Soupでのコーティング・メンテナンス

### 2.2 DXアプリの戦略的使命

開発されるアプリの役割は、これらバラバラに存在する接点を「株式会社みかも」という一つのブランド体験に統合することです。リサーチにより、各店舗の営業時間や定休日のズレ、立地の分散といった物理的な制約が明らかになりました。

アプリはこれらの「隙間」を埋め、営業時間外でも予約や閲覧を可能にし、店舗間の送客を自動化する役割を担う必要があります。
"""

# DXレポート セクション2: カーコーティング Soup
DX_REPORT_SECTION_2 = """
# 第1事業部：カーコーティング Soup（スープ）の深層分析

## 3.1 ブランド・フィロソフィーと市場ポジショニング

「カーコーティング Soup」は、貴社グループの中で最も「職人技術」と「高付加価値」を提供するブランドです。

### 3.1.1 コア・バリュー

Soupは「本物の艶と耐久性」を掲げ、最新鋭の設備と技術、さらには環境に配慮したコーティングプロセスを強みとしています。特筆すべきは、徳島県内において「ガラスコーティング・セラミックコーティング専門店」としての地位を確立している点です。

一般的なガソリンスタンド併設の簡易コーティングとは一線を画し、ドメイン soup.tokushima.jp を独自に取得して運用している点からも、専門ブランドとしての独立性を重視していることが伺えます。これは、DXアプリにおいても「ガソリンスタンドのオマケ」として扱うのではなく、プレミアムな独立サービスとしてUI/UXを設計する必要があることを示唆しています。

## 3.2 サービスポートフォリオと技術的特性

リサーチにより特定された提供サービスは多岐にわたり、顧客の多様なニーズに対応しています。

| サービスカテゴリ | 具体的な施術内容・特徴 | ターゲット顧客層 | DXアプリへの実装推奨機能 |
|---|---|---|---|
| ボディコーティング | ガラスコーティング、セラミックコーティング。耐久性と艶を重視。 | 新車購入者、愛車家、高級車オーナー | 施工証明書のデジタル化、メンテナンス時期の自動通知 |
| ウィンドウケア | ウィンドウコート。雨天時の視界確保。 | 通勤利用者、安全性重視のドライバー | 雨予報と連動したプッシュ通知販促 |
| 特殊部位ケア | 幌（ソフトトップ）コーティング。オープンカーの布製屋根保護。 | 趣味性の高いスポーツカー所有者 | 車種登録データに基づくターゲティング広告 |
| 下地処理・修復 | ミスト除去（鉄粉・ペンキ飛散除去）。 | 工業地帯の駐車利用者、中古車購入者 | Before/After画像のフォトギャラリー機能 |
| メンテナンス | コーティングメンテナンス。被膜の再生。 | 既存のコーティング施工者 | 定期的なリマインダー、予約の自動化 |

### 3.2.1 技術と環境への配慮

「環境にも配慮したコーティングを実施」という記述は、現代のSDGsやESG経営の観点からも重要な訴求ポイントです。使用する溶剤や排水処理において高い基準を設けている可能性があり、これをアプリ内のコンテンツ（読み物）として発信することで、ブランドへの信頼性を高めることができます。

## 3.3 顧客ジャーニーとDXによる課題解決

### 3.3.1 「見えない価値」の可視化

コーティングビジネスの最大の課題は、施工後の経年変化により効果が実感しにくくなること（価値の減衰）です。

- **現状**: 顧客は施工直後の輝きには感動するが、半年後のメンテナンス時期にはその感動を忘れている。
- **DX戦略**: 「デジタル・カーテカルテ」の実装

アプリ内で愛車の施工履歴を管理し、施工時の写真を保存。「1年前の輝きを取り戻しませんか？」という視覚的なアプローチを行うことで、メンテナンスの再来率（リピート率）を向上させます。

### 3.3.2 新車・直納コーティングの取り込み

「新車・直納コーティング」というメニューは、ディーラーでのコーティングではなく、より専門的なSoupでの施工を選ぶ層をターゲットにしています。

- **DX戦略**: Mnet（中古車販売）との連携。Mnetで車両を購入した顧客に対し、納車プロセスの一環としてアプリ上でSoupのコーティングオプションを提示し、ローンに組み込むなどのシームレスな購買体験を提供します。

## 3.4 施工事例の発信とコンテンツマーケティング

ウェブサイト上では「カーコーティングの事例紹介」として、定期的な更新が行われています。これは、現場が日常的に施工写真を撮影し、アップロードするオペレーションが既に定着していることを意味します。

- **アプリ連携**: 現在ウェブサイトに行っている投稿を、アプリのタイムラインにも自動連携させるべきです。「今週の施工事例」として、車種別（例：トヨタ・ハリアーの施工事例）に検索できるようにすることで、同じ車種に乗るユーザーの購買意欲を刺激できます。
"""

# DXレポート セクション3: Mnet 中古車販売
DX_REPORT_SECTION_3 = """
# 第2事業部：Mnet（エムネット）中古車販売の戦略的分析

## 4.1 事業モデルと提供価値

Mnet（クルマ買取専門店エムネット）は、三好郡東みよし町における車両流通のハブとして機能しています。

### 4.1.1 基本情報と立地戦略

- **所在地**: 徳島県三好郡東みよし町加茂5562-1
- **重要インサイト**: この住所は「みかも石油（ENEOS）」と同一です。つまり、SSと中古車販売店は同一敷地内、あるいは隣接地に存在しています。これはDX戦略上、極めて強力な武器となります。
- **営業時間**: 9:00～18:00
- **定休日**: 第1、第3日曜日
- **連絡先**: 0883-87-7716

### 4.1.2 「買取専門店」としての強み

「クルマ買取専門店」を標榜し、「高価買取・安心販売・丁寧対応」を掲げています。通常の販売店ではなく「買取」を強調するビジネスモデルは、仕入れ（Sourcing）をオークションに頼らず、ユーザーからの直接買取（ダイレクト・バイイング）で賄うことを目指していると推測されます。これにより中間マージンをカットし、販売価格競争力を高めたり、買取価格を上げたりすることが可能です。

## 4.2 インベントリ（在庫）戦略とデジタル展開

Mnetは「軽自動車から輸入車まで幅広いラインナップ」を取り扱っています。また、Goo-netやカーセンサーといった大手ポータルサイトを活用しており、既にデジタルチャネルでの集客を行っています。

### 4.2.1 DXアプリにおける在庫連携の課題

既存のポータルサイト（Goo-net等）は強力な集客力を持ちますが、掲載料がかかり、かつ競合他社と比較されやすい環境です。

**自社アプリの役割:**

自社アプリでは「シークレット在庫」や「入荷前情報」を配信可能です。「買取専門店」であるMnetには、オークションに出る前の、前オーナーから買い取ったばかりの「鮮度の高い車両」が存在します。これをアプリ会員限定で先行公開することで、アプリのインストール動機を強力に喚起できます。

## 4.3 顧客エンゲージメントと定休日の克服

Mnetの弱点は「第1・第3日曜日が定休日」である点です。日曜日は一般的に自動車購入検討のプライムタイムです。

**DXによる解決策: 「バーチャル展示場」**

店舗が閉まっていても、同一敷地内のみかも石油（24時間営業）は開いています。

1. 展示車両にQRコードを掲示する。
2. 来店客（給油客）が日曜日に車を見る。
3. QRをアプリで読み込むと、詳細スペック、内装の360度画像、エンジン始動動画などが閲覧できる。
4. その場でアプリから「翌営業日の商談予約」を入れると、特典（例：納車時ガソリン満タン）が付与される。

このように、アプリが休日の営業マンの代わりを務める仕組みを構築できます。

## 4.4 買取査定のDX化

「無料査定・出張査定」も行っています。

**アプリ機能: 「AIかんたん査定」**

ユーザーがアプリから車検証のQRコードと、外装の写真を数枚アップロードするだけで、概算の買取価格レンジを提示する機能です。

特に、みかも石油で日常的に給油し、Soupでメンテナンスしている車両であれば、Mnetはその車のコンディション（走行距離の伸び方、塗装の状態）をデータとして保有している可能性があります。これを利用して「あなたの車は、当店でずっと管理していたので、他店より5万円高く買い取ります」というオファーが可能になります。
"""

# DXレポート セクション4: みかも喫茶
DX_REPORT_SECTION_4 = """
# 第3事業部：みかも喫茶の運営実態とフードテック戦略

## 5.1 業態とオペレーションの特殊性

「みかも喫茶」は、他の3事業部とは異なるユニークな運営形態を持っています。

### 5.1.1 基本データと立地ギャップ

- **所在地**: 〒779-4701 徳島県三好郡東みよし町加茂3214-1
- **決定的事実**: みかも石油/Mnet（加茂5562-1）とは住所が異なります。番地にして約2300番の差があり、物理的に離れた場所に位置しています（車で数分の距離と推測されます）。この「距離」を埋めることがアプリの最重要課題の一つです。
- **営業時間**: 11:00～17:00。ランチタイムから夕方までの営業です。
- **定休日**: 火曜日
- **サービス形態**: 「テイクアウトのみ」（一部配達の示唆もあり）

### 5.1.2 メニュー構成と価格帯

提供メニューは軽食・洋食・ドリンクが中心で、手作り感と品質を重視した価格設定です。

- パンサラダ（温玉つき）: 650円
- クロックムッシュ: 594円
- いちごヨーグルトスムージー: 648円

この価格帯（500円～700円）は、コンビニエンスストアよりは高く、本格的なレストランよりは手軽という「中食（なかしょく）」のプレミアムゾーンに位置します。スムージーなどのドリンクメニューは、ドライブのお供としての需要が高く、SSとの親和性が高い商品です。

## 5.2 「テイクアウト専門」を逆手に取ったモバイルオーダー戦略

「テイクアウトのみ」かつ「お早めにご予約ください」という記述は、注文を受けてから調理するスタイル（Order to Make）であることを示唆しています。これには「待ち時間」という顧客ペインが発生します。

### 5.2.1 モバイルオーダー＆ペイ（MOP）の導入

DXアプリの機能として最も即効性があるのが、この部門です。

**ユーザーフロー:**

1. アプリでメニューを選ぶ。
2. 受取時間を指定する（例：「12:15」）。
3. アプリ内で決済（PayPay連携またはクレカ）を済ませる。
4. 店舗で待たずに受け取る。

### 5.2.2 支払い方法の統合

現在、支払方法は「現金」と「PayPay」に対応しています。アプリ開発においては、PayPayのAPI連携を行うか、独自の「みかもポイント」での支払いを可能にすることで、キャッシュレス化をさらに推進できます。

## 5.3 物理的距離を克服する「ついで買い」誘発モデル

SS（5562-1）と喫茶（3214-1）が離れているため、給油客が自然に喫茶に立ち寄ることは期待しにくい状況です。能動的な送客が必要です。

**シナリオ:**

みかも石油で給油完了時、アプリがプッシュ通知を送る。「給油ありがとうございます。これからランチですか？ 今から『みかも喫茶』で注文すれば、到着する頃に出来立ての『クロックムッシュ』をご用意できます。SS会員様は50円引き！」

**配送（デリバリー）の可能性:**

「配達」の記載があるため、一定エリア内（例えばMnetでの商談中や、SSでの洗車待ち時間）へのデリバリーが可能であれば、SSの待合室を「みかも喫茶のサテライト・イートインスペース」として活用することも可能です。
"""

# DXレポート セクション5: みかも石油
DX_REPORT_SECTION_5 = """
# 第4事業部：みかも石油（ENEOS）のインフラ力と集客構造

## 6.1 地域インフラとしてのステータス

みかも石油（三加茂SS）は、グループ全体の集客の入り口（ゲートウェイ）となる事業です。

### 6.1.1 施設概要

- **ブランド**: ENEOS。国内最大手ブランドの信頼性があります。
- **運営形態**: 24時間営業・セルフサービス。24時間営業は、地域内での優位性を確保する重要な要素です。

セルフサービス形式であるため、スタッフと顧客の接点が希薄になりがちです。これがDXアプリを導入すべき最大の理由となります。アプリが「デジタルの店員」として接客を行う必要があるからです。

**価格競争力:**

- レギュラー: 174円（会員173円）
- ハイオク: 185円（会員184円）
- 軽油: 161円（会員160円）

現金価格と会員価格の差は1円程度ですが、この「1円の差」がアプリインストールの強力なフックになります。

## 6.2 洗車ビジネスの収益化とサブスクリプション

SS経営において、燃料油は薄利多売であり、利益の源泉は「油外収益（洗車、オイル、タイヤ等）」にあります。

### 6.2.1 洗車メニューと価格帯

- スピード洗車（水洗い）: 300円～
- ワックス洗車: 600円～
- 高機能コート（ビーナスガード等）: 1,000円～2,000円超
- 手洗い洗車（プロスタッフによる施工）: 3,000円～5,000円程度

### 6.2.2 洗車サブスクリプション（定額制）の導入提案

天候に左右されやすい洗車売上を安定させるため、アプリ内で「洗車サブスク」を提供することが推奨されます。

- **プラン例**: 月額1,980円で、シャンプー洗車が何回でも無料。
- **効果**: 顧客は「元を取ろう」として来店頻度が増えます。来店回数が増えれば、給油の回数も増え、Mnetの展示車を見る機会も増えます。

## 6.3 競合環境分析

周辺（東みよし町周辺）には以下の競合が存在します。

- 三好SS（出光興産）：フルサービス、約4.6km先
- ENEOSウイング（吉野川SA）：高速道路SA内
- JA-SS、コスモ石油など

競合に対するみかも石油の差別化要因は「複合サービスの提供」にあります。単にガソリンを入れる場所ではなく、「美味しいスムージーが飲める」「車の売却相談ができる」「最高級のコーティングができる」という付加価値をアプリで束ねることで、価格競争から脱却できます。
"""

# DXレポート セクション6: 統合DX戦略＋結論
DX_REPORT_SECTION_6 = """
# 統合DX戦略：「みかもスーパーアプリ」の設計図

## 7.1 共通ID（Mikamo ID）による顧客統合

現在、各事業部でバラバラに管理されている（あるいは管理されていない）顧客情報を「Mikamo ID」として一本化します。

| 事業部 | 取得データ | 活用シナリオ |
|---|---|---|
| みかも石油 | 給油油種、給油量、来店頻度、洗車履歴 | 基本的な活動データの収集。ポイント付与の原資。 |
| Mnet | 車種、年式、走行距離、車検満了日 | 車検到来時の買替提案、コーティングの提案。 |
| Soup | 施工メニュー、施工日、ボディカラー | メンテナンス時期の通知、美観維持のアドバイス。 |
| みかも喫茶 | 好みのメニュー、購入時間帯 | SS来店時のクーポン配信（例：朝ならコーヒー、昼ならランチ）。 |

## 7.2 ロイヤリティ・プログラム（ポイント制度）の設計

グループ内通貨「みかもポイント」を発行し、事業部間の回遊を促します。

**貯める**: 給油1Lにつき1ポイント、洗車で10ポイント、喫茶購入額の1%、車購入で10,000ポイント。

**使う**: 1ポイント＝1円として、ガソリン代にはもちろん、「みかも喫茶」の食事や「Soup」のメンテナンス費用に充当可能にします。

**戦略的意図:**
「ガソリン（必需品）」でコツコツ貯めたポイントを、「スムージー（楽しみ）」や「コーティング（贅沢）」に使えるようにすることで、ポイントの知覚価値を高め、顧客の満足度を向上させます。

## 7.3 アプリの主要機能要件リスト

1. **デジタル会員証**: SSの計量機にかざすためのQRコード表示（EneKeyとの紐付けも検討）。現在のガソリン価格表示（会員価格）。
2. **モバイルオーダー（喫茶）**: 事前注文・決済機能。調理完了通知。
3. **メンテナンス管理（Soup & Mnet）**: 愛車のステータス表示。コーティング施工証明書のデジタル表示。次回メンテナンス、車検日のカウントダウン。
4. **在庫検索＆査定（Mnet）**: 新着車両のプッシュ通知。AI画像査定申し込みフォーム。
5. **クーポン＆ニュース**: 雨の日クーポン（喫茶）、晴れの日洗車クーポン（SS）。地域情報の発信（東みよし町のイベント情報など）。

## 7.4 開発フェーズにおける留意点

### 7.4.1 ハードウェア連携の壁

ENEOSのPOSシステム（計量機）はセキュリティが高く、外部アプリとの直接API連携が困難な場合があります。

**対策**: アプリ画面のバーコードをPOSのリーダーに読ませる形式（会員カードのデジタル化）が現実的な解となります。あるいは、レシートをカメラで撮影してポイントを後付けするOCR機能を実装することで、POS改修コストを回避できます。

### 7.4.2 オペレーション教育

アプリを作っても、現場スタッフが使いこなせなければ意味がありません。特に「みかも喫茶」では、調理中に注文通知が来るため、タブレット操作のオペレーションを厨房フローに組み込む必要があります。「Soup」や「Mnet」では、顧客対応履歴をこまめにシステムに入力する業務習慣が求められます。

---

## 8. 結論：データが繋ぐ「地域No.1カーライフ・エコシステム」

本リサーチにより、株式会社みかもの4事業部は、それぞれが単独でも高いポテンシャルを持ちながら、統合されることで相互に弱点を補完し合える関係にあることが明らかになりました。

- **みかも石油**は、圧倒的な「集客数」と「頻度」を持っていますが、顧客単価と利益率は低めです。
- **SoupとMnet**は、高い「単価」と「利益」を持っていますが、来店頻度は低く、新規客獲得コストが高いです。
- **みかも喫茶**は、顧客の「情緒的満足」を高め、ブランドへの愛着を深める接着剤の役割を果たします。

DXアプリは、みかも石油の「頻度」を、MnetやSoupの「高収益」へと変換するパイプラインとなるべきです。また、みかも喫茶のメニューをデジタル化することで、給油という無機質な作業に「彩り」を加え、他店にはない顧客体験を提供できます。

東みよし町という限定された商圏において、これら全てのサービスを掌（スマホ）の中で完結させるこの取り組みは、地方企業のDXモデルケースとして極めて先進的かつ合理的な戦略であると結論付けられます。
"""


def seed_dx_knowledge():
    """DXレポートをナレッジベースに登録"""
    print("=" * 60)
    print("DXレポート ナレッジベース登録スクリプト")
    print("=" * 60)
    print()

    with Session(engine) as session:
        # mikamoテナントを取得（存在しなければ作成）
        statement = select(Tenant).where(Tenant.name == "mikamo")
        tenant = session.exec(statement).first()

        if not tenant:
            print("⚠️  mikamoテナントが見つかりません。")
            print("   アプリを起動して初期データを作成してください。")
            return

        print(f"✓ テナント: {tenant.name} (ID: {tenant.id})")

        # 管理者ユーザーを取得
        statement = select(User).where(User.role == "admin")
        admin_user = session.exec(statement).first()

        if not admin_user:
            print("⚠️  管理者ユーザーが見つかりません。")
            print("   先に管理者ユーザーを作成してください。")
            return

        print(f"✓ 登録者: {admin_user.full_name} ({admin_user.email})")
        print()

        # 事業部門を取得
        business_units = {}
        for code in ["soup", "mnet", "cafe", "gas"]:
            statement = select(BusinessUnit).where(BusinessUnit.code == code)
            bu = session.exec(statement).first()
            if bu:
                business_units[code] = bu
                print(f"✓ 事業部門: {bu.name} ({bu.code}, ID: {bu.id})")
        print()

        # DXレポートのセクションを定義
        knowledge_items_data = [
            {
                "title": "DXレポート: エグゼクティブサマリー＆序論",
                "content": DX_REPORT_SECTION_1,
                "category": "DXレポート",
                "source": "Claude AI調査レポート (2025年)",
                "business_unit_id": None,  # 全社共通
                "tags": ["DX", "戦略", "サマリー", "序論"]
            },
            {
                "title": "DXレポート: カーコーティング Soup 分析",
                "content": DX_REPORT_SECTION_2,
                "category": "DXレポート",
                "source": "Claude AI調査レポート (2025年)",
                "business_unit_id": business_units.get("soup", {}).id if business_units.get("soup") else None,
                "tags": ["DX", "Soup", "コーティング", "サービス分析"]
            },
            {
                "title": "DXレポート: Mnet 中古車販売 分析",
                "content": DX_REPORT_SECTION_3,
                "category": "DXレポート",
                "source": "Claude AI調査レポート (2025年)",
                "business_unit_id": business_units.get("mnet", {}).id if business_units.get("mnet") else None,
                "tags": ["DX", "Mnet", "中古車", "販売", "買取"]
            },
            {
                "title": "DXレポート: みかも喫茶 分析",
                "content": DX_REPORT_SECTION_4,
                "category": "DXレポート",
                "source": "Claude AI調査レポート (2025年)",
                "business_unit_id": business_units.get("cafe", {}).id if business_units.get("cafe") else None,
                "tags": ["DX", "喫茶", "フード", "モバイルオーダー"]
            },
            {
                "title": "DXレポート: みかも石油 分析",
                "content": DX_REPORT_SECTION_5,
                "category": "DXレポート",
                "source": "Claude AI調査レポート (2025年)",
                "business_unit_id": business_units.get("gas", {}).id if business_units.get("gas") else None,
                "tags": ["DX", "石油", "ENEOS", "洗車", "サブスク"]
            },
            {
                "title": "DXレポート: 統合DX戦略＆結論",
                "content": DX_REPORT_SECTION_6,
                "category": "DXレポート",
                "source": "Claude AI調査レポート (2025年)",
                "business_unit_id": None,  # 全社共通
                "tags": ["DX", "戦略", "統合", "ポイント", "アプリ機能"]
            }
        ]

        # 既存のDXレポートナレッジを削除（更新のため）
        existing_items = session.exec(
            select(KnowledgeItem).where(
                KnowledgeItem.category == "DXレポート"
            )
        ).all()

        if existing_items:
            print(f"! 既存のDXレポートナレッジ {len(existing_items)} 件を削除します...")
            for item in existing_items:
                session.delete(item)
            session.commit()
            print("✓ 削除完了")
            print()

        # ナレッジアイテムを登録
        print("ナレッジアイテムを登録中...")
        for i, data in enumerate(knowledge_items_data, 1):
            knowledge_item = KnowledgeItem(
                tenant_id=tenant.id,
                business_unit_id=data["business_unit_id"],
                title=data["title"],
                content=data["content"],
                category=data["category"],
                source=data["source"],
                tags=data["tags"],
                created_by=admin_user.id
            )
            session.add(knowledge_item)
            session.commit()
            session.refresh(knowledge_item)

            bu_name = "全社共通" if not data["business_unit_id"] else f"事業部ID: {data['business_unit_id']}"
            print(f"  [{i}/6] {data['title']} ({bu_name})")

        print()
        print("=" * 60)
        print("✅ DXレポートのナレッジ登録が完了しました！")
        print("   合計 6 件のナレッジアイテムを登録しました。")
        print("=" * 60)


if __name__ == "__main__":
    seed_dx_knowledge()
